<head><meta content="text/html; charset=UTF-8" http-equiv="Content-Type"><style type="text/css">table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style></head><body><pre class="sourceCode"><code class="sourceCode"><span title="CommentTok" class="co">!-*- mode: compilation; default-directory: &quot;/tmp/&quot; -*-</span>
<span title="CommentTok" class="co">!Compilation started at Thu Jun  5 01:52:03</span>
<span title="CommentTok" class="co">!</span>
<span title="CommentTok" class="co">!make f &amp;&amp; for a in &#39;&#39; a bark book treat common squad confuse ; do echo $a | ./f ; done</span>
<span title="CommentTok" class="co">!gfortran -std=f2008 -Wall -fopenmp -ffree-form -fall-intrinsics -fimplicit-none -g f.f08 -o f</span>
<span title="CommentTok" class="co">! T                      </span>
<span title="CommentTok" class="co">! T  A                    NA</span>
<span title="CommentTok" class="co">! T  BARK                 BO NA RE XK</span>
<span title="CommentTok" class="co">! F  BOOK                 OB BO -- --</span>
<span title="CommentTok" class="co">! T  TREAT                GT RE ER NA TG</span>
<span title="CommentTok" class="co">! F  COMMON               PC OB ZM -- -- --</span>
<span title="CommentTok" class="co">! T  SQUAD                FS DQ HU NA QD</span>
<span title="CommentTok" class="co">! T  CONFUSE              CP BO NA FS HU FS RE</span>
<span title="CommentTok" class="co">!</span>
<span title="CommentTok" class="co">!Compilation finished at Thu Jun  5 01:52:03</span>

<span title="KeywordTok" class="kw">program</span> abc
  <span title="KeywordTok" class="kw">implicit</span> <span title="KeywordTok" class="kw">none</span>
  <span title="DataTypeTok" class="dt">integer</span>, <span title="DataTypeTok" class="dt">parameter</span> <span title="DataTypeTok" class="dt">::</span> nblocks <span title="KeywordTok" class="kw">=</span> <span title="DecValTok" class="dv">20</span>
  <span title="DataTypeTok" class="dt">character(len=nblocks)</span> <span title="DataTypeTok" class="dt">::</span> goal
  <span title="DataTypeTok" class="dt">integer</span>, <span title="DataTypeTok" class="dt">dimension(nblocks)</span> <span title="DataTypeTok" class="dt">::</span> solution
  <span title="DataTypeTok" class="dt">character(len=2)</span>, <span title="DataTypeTok" class="dt">dimension(0:nblocks)</span> <span title="DataTypeTok" class="dt">::</span> blocks_copy, blocks <span title="KeywordTok" class="kw">=</span> <span title="KeywordTok" class="kw">&amp;</span>
       <span title="KeywordTok" class="kw">&amp;(/</span><span title="StringTok" class="st">&#39;--&#39;</span>,<span title="StringTok" class="st">&#39;BO&#39;</span>,<span title="StringTok" class="st">&#39;XK&#39;</span>,<span title="StringTok" class="st">&#39;DQ&#39;</span>,<span title="StringTok" class="st">&#39;CP&#39;</span>,<span title="StringTok" class="st">&#39;NA&#39;</span>,<span title="StringTok" class="st">&#39;GT&#39;</span>,<span title="StringTok" class="st">&#39;RE&#39;</span>,<span title="StringTok" class="st">&#39;TG&#39;</span>,<span title="StringTok" class="st">&#39;QD&#39;</span>,<span title="StringTok" class="st">&#39;FS&#39;</span>,<span title="StringTok" class="st">&#39;JW&#39;</span>,<span title="StringTok" class="st">&#39;HU&#39;</span>,<span title="StringTok" class="st">&#39;VI&#39;</span>,<span title="StringTok" class="st">&#39;AN&#39;</span>,<span title="StringTok" class="st">&#39;OB&#39;</span>,<span title="StringTok" class="st">&#39;ER&#39;</span>,<span title="StringTok" class="st">&#39;FS&#39;</span>,<span title="StringTok" class="st">&#39;LY&#39;</span>,<span title="StringTok" class="st">&#39;PC&#39;</span>,<span title="StringTok" class="st">&#39;ZM&#39;</span><span title="KeywordTok" class="kw">/)</span>
  <span title="DataTypeTok" class="dt">logical</span> <span title="DataTypeTok" class="dt">::</span> valid
  <span title="DataTypeTok" class="dt">integer</span> <span title="DataTypeTok" class="dt">::</span> i, iostat
  <span title="FunctionTok" class="fu">read(</span><span title="DecValTok" class="dv">5</span>,<span title="FunctionTok" class="fu">*</span>,<span title="FunctionTok" class="fu">iostat</span><span title="KeywordTok" class="kw">=</span><span title="FunctionTok" class="fu">iostat)</span> goal
  <span title="KeywordTok" class="kw">if</span> (iostat <span title="KeywordTok" class="kw">.ne.</span> <span title="DecValTok" class="dv">0</span>) goal <span title="KeywordTok" class="kw">=</span> <span title="StringTok" class="st">&#39;&#39;</span>
  <span title="KeywordTok" class="kw">call</span> ucase(goal)
  solution <span title="KeywordTok" class="kw">=</span> <span title="DecValTok" class="dv">0</span>
  blocks_copy <span title="KeywordTok" class="kw">=</span> blocks
  valid <span title="KeywordTok" class="kw">=</span> assign_block(goal(<span title="DecValTok" class="dv">1</span>:<span title="KeywordTok" class="kw">len_trim</span>(goal)), blocks, solution, <span title="DecValTok" class="dv">1</span>)
  <span title="FunctionTok" class="fu">write(</span><span title="DecValTok" class="dv">6</span>,<span title="FunctionTok" class="fu">*)</span> valid, <span title="StringTok" class="st">&#39; &#39;</span><span title="KeywordTok" class="kw">//</span>goal, (<span title="StringTok" class="st">&#39; &#39;</span><span title="KeywordTok" class="kw">//</span>blocks_copy(solution(i)), i<span title="KeywordTok" class="kw">=</span><span title="DecValTok" class="dv">1</span>,<span title="KeywordTok" class="kw">len_trim</span>(goal))

<span title="CommentTok" class="co">contains</span>

  <span title="KeywordTok" class="kw">recursive</span> <span title="KeywordTok" class="kw">function</span> assign_block(goal, blocks, solution, n) <span title="KeywordTok" class="kw">result</span>(valid)
    <span title="KeywordTok" class="kw">implicit</span> <span title="KeywordTok" class="kw">none</span>
    <span title="DataTypeTok" class="dt">logical</span> <span title="DataTypeTok" class="dt">::</span> valid
    <span title="DataTypeTok" class="dt">character(len=*)</span>, <span title="DataTypeTok" class="dt">intent(in)</span> <span title="DataTypeTok" class="dt">::</span> goal
    <span title="DataTypeTok" class="dt">character(len=2)</span>, <span title="DataTypeTok" class="dt">dimension(0:)</span>, <span title="DataTypeTok" class="dt">intent(inout)</span> <span title="DataTypeTok" class="dt">::</span> blocks
    <span title="DataTypeTok" class="dt">integer</span>, <span title="DataTypeTok" class="dt">dimension(:)</span>, <span title="DataTypeTok" class="dt">intent(out)</span> <span title="DataTypeTok" class="dt">::</span> solution
    <span title="DataTypeTok" class="dt">integer</span>, <span title="DataTypeTok" class="dt">intent(in)</span> <span title="DataTypeTok" class="dt">::</span> n
    <span title="DataTypeTok" class="dt">integer</span> <span title="DataTypeTok" class="dt">::</span> i
    <span title="DataTypeTok" class="dt">character(len=2)</span> <span title="DataTypeTok" class="dt">::</span> backing_store
    valid <span title="KeywordTok" class="kw">=</span> <span title="OtherTok" class="ot">.true.</span>
    <span title="KeywordTok" class="kw">if</span> (<span title="FunctionTok" class="fu">len</span>(goal)<span title="KeywordTok" class="kw">+</span><span title="DecValTok" class="dv">1</span> <span title="KeywordTok" class="kw">.eq.</span> n) <span title="KeywordTok" class="kw">return</span>
    <span title="KeywordTok" class="kw">do</span> i<span title="KeywordTok" class="kw">=</span><span title="DecValTok" class="dv">1</span>, <span title="FunctionTok" class="fu">size</span>(blocks)
       <span title="KeywordTok" class="kw">if</span> (<span title="KeywordTok" class="kw">index</span>(blocks(i),goal(n:n)) <span title="KeywordTok" class="kw">.ne.</span> <span title="DecValTok" class="dv">0</span>) <span title="KeywordTok" class="kw">then</span>
          backing_store <span title="KeywordTok" class="kw">=</span> blocks(i)
          blocks(i) <span title="KeywordTok" class="kw">=</span> <span title="StringTok" class="st">&#39;&#39;</span>
          solution(n) <span title="KeywordTok" class="kw">=</span> i
          <span title="KeywordTok" class="kw">if</span> (assign_block(goal, blocks, solution, n<span title="KeywordTok" class="kw">+</span><span title="DecValTok" class="dv">1</span>)) <span title="KeywordTok" class="kw">return</span>
          blocks(i) <span title="KeywordTok" class="kw">=</span> backing_store
       <span title="KeywordTok" class="kw">end if</span>
    <span title="KeywordTok" class="kw">end do</span>
    valid <span title="KeywordTok" class="kw">=</span> <span title="OtherTok" class="ot">.false.</span>
    <span title="KeywordTok" class="kw">return</span>
  <span title="KeywordTok" class="kw">end function</span> assign_block

  <span title="KeywordTok" class="kw">subroutine</span> ucase(a)
    <span title="KeywordTok" class="kw">implicit</span> <span title="KeywordTok" class="kw">none</span>
    <span title="DataTypeTok" class="dt">character(len=*)</span>, <span title="DataTypeTok" class="dt">intent(inout)</span> <span title="DataTypeTok" class="dt">::</span> a
    <span title="DataTypeTok" class="dt">integer</span> <span title="DataTypeTok" class="dt">::</span> i, j
    <span title="KeywordTok" class="kw">do</span> i <span title="KeywordTok" class="kw">=</span> <span title="DecValTok" class="dv">1</span>, <span title="KeywordTok" class="kw">len_trim</span>(a)
       j <span title="KeywordTok" class="kw">=</span> <span title="KeywordTok" class="kw">index</span>(<span title="StringTok" class="st">&#39;abcdefghijklmnopqrstuvwxyz&#39;</span>,a(i:i))
       <span title="KeywordTok" class="kw">if</span> (j <span title="KeywordTok" class="kw">.ne.</span> <span title="DecValTok" class="dv">0</span>) a(i:i) <span title="KeywordTok" class="kw">=</span> <span title="StringTok" class="st">&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;</span>(j:j)
    <span title="KeywordTok" class="kw">end do</span>
  <span title="KeywordTok" class="kw">end subroutine</span> ucase

<span title="KeywordTok" class="kw">end program</span> abc</code></pre></body>